package com.sist.mapred;

import java.io.FileReader;
import java.io.IOException;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;

/*
 * 		1. read a book
 * 		2. write a book
 * 
 * 			==> LongWritable , Text
 * 						1			read a book
 * 			==> read 1
 *					 a 1
 * 				 book 1
 * 		MapReduce
 * 		 Mapper		 셔플							Reducer
 * 		 단어별 구분	sort , 같은 단어별로 묶는다
 * 			read 1		 a [1,1]						a 2
 * 			a	  1		 book[1,1]					book 2
 * 			book 1		 read [1]						read 1
 * 			write 1    write [1]					write 2
 * 			a	  1
 * 			book 1장","공포","유머","웃음","개그",
			"행복","전
 */
public class MovieMapper extends Mapper<LongWritable, Text, Text, IntWritable>{ //맵리듀스의 형태
	private final IntWritable one=new IntWritable(1);
	private Text res=new Text();
	private String[] feel = {
			"쉽[가-힣]+",
			"앞장[가-힣]+",
			"용기[가-힣]*",
			"강점[가-힣]*",
			"각오[가-힣]*",
			"만만[가-힣]+",
			"용자[가-힣]*",
			"소신[가-힣]*",
			"문제[가-힣]?",
			"용감[가-힣]*",
			"감동[가-힣]*",
			"은총[가-힣]*",
			"감명[가-힣]*",
			"따스[가-힣]+",
			"감동[가-힣]*",
			"은총[가-힣]*",
			"감명[가-힣]*",
			"따스[가-힣]+",
			"안정[가-힣]*",
			"안심[가-힣]*",
			"안도[가-힣]*",
			"순조로[가-힣]+",
			"위안[가-힣]*",
			"수월[가-힣]*",
			"순조롭[기-힣]+",
			"감사[가-힣]*",
			"덕분[가-힣]+",
			"고마[가-힣]+",
			"보훈[가-힣]*",
			"보답[가-힣]*",
			"고맙[가-힣]+",
			"희망[가-힣]*",
			"믿음[가-힣]*",
			"믿[가-힣]+",
			"신뢰[가-힣]*",
			"훌륭[가-힣]+",
			"희망[가-힣]*",
			"든든[가-힣]*",
			"경의[가-힣]*",
			"가능[가-힣]*",
			"가능하[가-힣]+",
			"가능한[가-힣]*",
			"기대[가-힣]*",
			"희망[가-힣]*",
			"원하[가-힣]+",
			"원함[가-힣]*",
			"바라[가-힣]*",
			"바람[가-힣]*",
			"바램",
			"기대[가-힣]*",
			"맑[가-힣]*",
			"바람직[가-힣]*",
			"떨다",
			"떨고[가-힣]*",
			"희망[가-힣]*",
			"유망[가-힣]*",
			"설렘[가-힣]*",
			"설레[가-힣]*",
			"의욕[가-힣]*",
			"소원[가-힣]*",
			"떨리[가-힣]*",
			"열망[가-힣]*",
			"들뜨[가-힣]*",
			"들뜸[가-힣]*",
			"들떠[가-힣]*",
			"떨리[가-힣]*",
			"떨려[가-힣]*",
			"요망$",
			"영원[가-힣]*",
			"원해[가-힣]*",
			"원하[가-힣]+",
			"희망[가-힣]*",
			"긍정적[가-힣]+",
			"긍정[가-힣]*",
			"매력[가-힣]*",
			"행복[가-힣]*",
			"아름답[가-힣]*",
			"아름다[가-힣]*",
			"예쁘[가-힣]*",
			"예쁘지[가-힣]*",
			"예쁜[가-힣]*",
			"예뻐[가-힣]*",
			"예쁘지[가-힣]*",
			"멋지[가-힣]+",
			"멋져[가-힣]*",
			"멋있[가-힣]+",
			"멋진[가-힣]*",
			"열정[가-힣]*",
			"선호[가-힣]*",
			"시원[가-힣]*",
			"매력[가-힣]*",
			"호재[가-힣]*",
			"간편[가-힣]*",
			"반하[가-힣]+",
			"반했[가-힣]*+",
			"반함",
			"^마음[가-힣]*들[가-힣]*$",
			"^마음[가-힣]*듬$",
			"좋아[가-힣]*",
			"대박[가-힣]*",
			"열정[가-힣]*",
			"사랑[가-힣]*",
			"^마음[가-힣]*당기[가-힣]*$",
			"^마음[가-힣]*당겨[가-힣]*$",
			"로맨틱[가-힣]*",
			"멋스[가-힣]+",
			"우호[가-힣]*",
			"상큼[가-힣]*",
			"흐뭇[가-힣]*",
			"돕[가-힣]+",
			"응원[가-힣]*",
			"축하[가-힣]*",
			"배려[가-힣]*",
			"위로[가-힣]*",
			"돌보[가-힣]*",
			"돌봐[가-힣]*",
			"봐주[가-힣]*",
			"봐줘[가-힣]*",
			"격려[가-힣]*",
			"양보[가-힣]*",
			"베푸[가-힣]+",
			"베풀[가-힣]+",
			"겸손[가-힣]*",
			"선행[가-힣]*",
			"돌봄",
			"돌보[가-힣]*",
			"돌봐[가-힣]*",
			"양해[가-힣]*",
			"배려[가-힣]*",
			"배의[가-힣]*",
			"독려[가-힣]*",
			"겸손[가-힣]*",
			"호의[가-힣]*",
			"박식[가-힣]*",
			"덕담[가-힣]*",
			"관심[가-힣]*",
			"봉사[가-힣]*",
			"공포[가-힣]*",
			"도망[가-힣]*",
			"위협[가-힣]*",
			"걱정[가-힣]*",
			"두려[가-힣]+",
			"도주[가-힣]*",
			"위축[가-힣]*",
			"염려[가-힣]*",
			"위기[가-힣]*",
			"불안[가-힣]*",
			"위험[가-힣]*",
			"공포[가-힣]*",
			"떨리[가-힣]+",
			"위해를[가-힣]*",
			"우려[가-힣]*",
			"짜증[가-힣]*",
			"분통[가-힣]*",
			"등신[가-힣]*",
			"억울[가-힣]*",
			"공분[가-힣]*",
			"화나[가-힣]*",
			"분하[가-힣]*",
			"분해[가-힣]*",
			"억울[가-힣]*",
			"부들부들[가-힣]*",
			"바들바들[가-힣]*",
			"때리[가-힣]+",
			"도발[가-힣]*",
			"보복[가-힣]*",
			"분노[가-힣]*",
			"분함[가-힣]*",
			"멘붕[가-힣]*",
			"멘탈붕괴[가-힣]*",
			"쿠크깨[가-힣]+",
			"배신[가-힣]*",
			"섭섭[가-힣]*",
			"무능[가-힣]*",
			"어이[가-힣]+",
			"허무[가-힣]*",
			"실망[가-힣]*",
			"아까[가-힣]+",
			"후회[가-힣]*",
			"실망[가-힣]*",
			"황당[가-힣]*",
			"아쉬[가-힣]*",
			"유리멘탈[가-힣]*",
			"아깝[가-힣]*",
			"아쉽[가-힣]*",
			"미안[가-힣]*",
			"죄송[가-힣]*",
			"잘못[가-힣]*",
			"반의[가-힣]*",
			"대고[가-힣]*",
			"반기[가-힣]*",
			"반감[가-힣]*",
			"거부[가-힣]*",
			"금물[가-힣]*",
			"모순[가-힣]*",
			"걸림돌[가-힣]*",
			"반해[가-힣]*",
			"거짓[가-힣]*",
			"반발[가-힣]*",
			"따지[가-힣]+",
			"가짜[가-힣]*",
			"반박[가-힣]*",
			"무리[가-힣]*",
			"말썽[가-힣]*",
			"엉터리[가-힣]*",
			"욕하[가-힣]+",
			"원수[가-힣]*",
			"원한[가-힣]*",
			"박해[가-힣]*",
			"불쾌[가-힣]*",
			"시끄[가-힣]+",
			"증오[가-힣]*",
			"원성[가-힣]*",
			"극도[가-힣]*",
			"득실[가-힣]*",
			"싫어[가-힣]*",
			"혐오[가-힣]*",
			"박대[가-힣]*",
			"무분별[가-힣]*",
			"바보[가-힣]*",
			"디스[가-힣]*",
			"무서[가-힣]+",
			"밉[가-힣]+",
			"불만[가-힣]*",
			"시달[가-힣]+",
			"배리[가-힣]+",
			"비난[가-힣]*",
			"안되[가-힣]*",
			"별로[가-힣]*",
			"미치[가-힣]*",
			"무섭[가-힣]*",
			"미워[가-힣]*",
			"안된[가-힣]*",
			"미친[가-힣]*",
			"미치[가-힣]+",
			"안되[가-힣]+",
			"애환[가-힣]*",
			"미워[가-힣]*",
			"괴롭[가-힣]+",
			"쓸쓸[가-힣]*",
			"비참[가-힣]*",
			"우울[가-힣]*",
			"불행[가-힣]*",
			"불쌍[가-힣]*",
			"연민[가-힣]*",
			"외로[가-힣]+",
			"슬프[가-힣]+",
			"슬픔[가-힣]*",
			"비극[가-힣]*",
			"슬픈[가-힣]*",
			"슬퍼[가-힣]*",
			"안타까[가-힣]+",
			"안타깝[가-힣]+",
			"외롭[가-힣]+",
			"미움[가-힣]*",
			"무식[가-힣]*",
			"부끄[가-힣]*",
			"창피[가-힣]*",
			"굴욕[가-힣]*",
			"망신[가-힣]*",
			"민망[가-힣]*",
			"무안[가-힣]*",
			"무시[가-힣]*",
			"막연[가-힣]*",
			"번거[가-힣]+",
			"골치[가-힣]*",
			"심각[가-힣]*",
			"혼란[가-힣]*",
			"난처[가-힣]*",
			"근심[가-힣]*",
			"혼선[가-힣]*",
			"걱정[가-힣]*",
			"곤란[가-힣]*",
			"고생[가-힣]*",
			"어색[가-힣]*",
			"부담[가-힣]*",
			"고충[가-힣]*",
			"고비[가-힣]*",
			"무겁[가-힣]*",
			"바쁘[가-힣]+",
			"복잡[가-힣]*",
			"밀리[가-힣]+",
			"부진[가-힣]*",
			"어렵[가-힣]*",
			"심각[가-힣]*",
			"문제[가-힣]*",
			"어려운[가-힣]*",
			"질투[가-힣]*",
			"부럽[가-힣]*",
			"시기[가-힣]*",
			"경계[가-힣]*",
			"불신[가-힣]*",
			"의심[가-힣]*",
			"과장[가-힣]*",
			"의혹[가-힣]*"
	};
	private Pattern[] p=new Pattern[feel.length];
	private Matcher[] m=new Matcher[feel.length];
	
	@Override
	protected void map(LongWritable key, Text value, Mapper<LongWritable, Text, Text, IntWritable>.Context context)
			throws IOException, InterruptedException {
		for(int i=0;i<p.length;i++)
		{
			p[i]=Pattern.compile(feel[i]);
		}
		for(int i=0;i<m.length;i++)
		{
			m[i]=p[i].matcher(value.toString());
			while(m[i].find())
			{
				if(i<137){
				res.set("긍정");
				}
				else{
				res.set("부정");
				}
				context.write(res,one);
			}
		}
	}
	
}
